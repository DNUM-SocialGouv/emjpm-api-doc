
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Reference Emjpm API</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen-a1ce949a.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-bccf8c07.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-c5541673.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-6f72888a.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#environnements" class="toc-h2 toc-link" data-title="Environnements">Environnements</a>
                  </li>
                  <li>
                    <a href="#demande-de-d-39-acces-a-l-39-api" class="toc-h2 toc-link" data-title="Demande de d'accès à l'API">Demande de d'accès à l'API</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#recuperer-les-jetons-oauth" class="toc-h1 toc-link" data-title="Récupérer les jetons OAuth.">Récupérer les jetons OAuth.</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#recuperer-un-code-d-39-autorisation" class="toc-h2 toc-link" data-title="Récupérer un code d'autorisation">Récupérer un code d'autorisation</a>
                  </li>
                  <li>
                    <a href="#echanger-le-code-d-39-autorisation-contre-un-token-d-39-acces" class="toc-h2 toc-link" data-title="Echanger le code d'autorisation contre un token d'accès">Echanger le code d'autorisation contre un token d'accès</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#mesures" class="toc-h1 toc-link" data-title="Mesures">Mesures</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#l-39-objet-mesure" class="toc-h2 toc-link" data-title="L'objet mesure">L'objet mesure</a>
                  </li>
                  <li>
                    <a href="#lister-toutes-les-mesures" class="toc-h2 toc-link" data-title="Lister toutes les mesures">Lister toutes les mesures</a>
                  </li>
                  <li>
                    <a href="#recuperer-une-mesure" class="toc-h2 toc-link" data-title="Récupérer une mesure">Récupérer une mesure</a>
                  </li>
                  <li>
                    <a href="#creer-une-mesure" class="toc-h2 toc-link" data-title="Créer une mesure">Créer une mesure</a>
                  </li>
                  <li>
                    <a href="#modifier-une-mesure" class="toc-h2 toc-link" data-title="Modifier une mesure">Modifier une mesure</a>
                  </li>
                  <li>
                    <a href="#supprimer-une-mesure" class="toc-h2 toc-link" data-title="Supprimer une mesure">Supprimer une mesure</a>
                  </li>
                  <li>
                    <a href="#supprimer-toutes-les-mesure" class="toc-h2 toc-link" data-title="Supprimer toutes les mesure">Supprimer toutes les mesure</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#antennes-service" class="toc-h1 toc-link" data-title="Antennes (service)">Antennes (service)</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#lister-toutes-les-antennes" class="toc-h2 toc-link" data-title="Lister toutes les antennes">Lister toutes les antennes</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://emjpm.fabrique.social.gouv.fr/application/token-request'>Obtenez des accès de production à l'api ici</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Bienvenue dans la documentation de l&#39;API eMJPM à destination des logiciels métiers, vous trouverez ici des guides et des documentations vous permettant de commencer aussi rapidement que possible.</p>

<p>L&#39;API eMJPM est organisée en REST, elle retourne des réponses encodées en JSON,
et utilise des verbes, des codes de réponses, et des méchanismes d&#39;authentification HTTP standard.</p>
<h2 id='environnements'>Environnements</h2>
<p><strong>Test</strong> <a href="https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr">https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr</a></p>

<p><strong>Production</strong> <a href="https://api-emjpm.fabrique.social.gouv.fr">https://api-emjpm.fabrique.social.gouv.fr</a></p>

<p>Lors du développement de votre solution logicielle, nous vous recommandons d&#39;utiliser l&#39;environnement de test</p>

<p><a href="https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr">https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr</a></p>

<p>remplacez votre client_id et votre client_token de test par ceux obtenues suite à votre demande d&#39;autorisation</p>

<p>L&#39;environnement de test est fonctionnellement identique à l&#39;environnement de production.</p>
<h2 id='demande-de-d-39-acces-a-l-39-api'>Demande de d&#39;accès à l&#39;API</h2>
<p>L&#39;API eMJPM utilise des tokens pour authentifier les requêtes via le méchanisme HTTP Bearer.</p>

<p>Pour utiliser l&#39;API eMJPM en production (https://api-emjpm.fabrique.social.gouv.fr), vous devez obtenir un client_id et un client_token de production. Pour ce faire, veuillez remplir une demande d&#39;autorisation sur notre <a href="https://emjpm.fabrique.social.gouv.fr/application/token-request">page dédié</a>.</p>
<h1 id='recuperer-les-jetons-oauth'>Récupérer les jetons OAuth.</h1><h2 id='recuperer-un-code-d-39-autorisation'>Récupérer un code d&#39;autorisation</h2>
<p>Pour obtenir un code d&#39;autorisation veuillez rediriger l&#39;utilisateur vers l&#39;url emjpm construite de la façon suivante:</p>

<p><strong>client_id</strong>: L’ID editor qui vous a été fourni.</p>

<p><strong>redirect_uri</strong>: L’URL vers laquelle vous souhaitez rediriger l’utilisateur qui se connecte. Cette URL capturera la réponse provenant du login EMJPM.</p>

<p><strong>state</strong> (optionnel): Une valeur de chaîne créée par votre app pour stabiliser la demande et le rappel. Ce paramètre doit être utilisé pour prévenir la falsification de demande intersite et vous sera renvoyé intact dans votre URI de redirection.</p>

<p><code>https://apitest-emjpm.dev2.fabrique.social.gouv.fr/application/authorization?client_id=${votre editor_id de test}&amp;redirect_uri=${url de redirection vers votre application}&amp;state={chaine aléatoire}</code></p>

<p>Si l&#39;utilisateur n&#39;est pas déja connecté à EMJPM, il sera invité à se connecter, puis redirigé vers le processus de connexion. Vous n’avez rien à faire de votre côté pour activer ce comportement, car il s’exécute automatiquement.</p>

<p>À cette étape du processus de connexion, l’utilisateur accède à un écran de permissions et peut choisir d’annuler l’opération ou d’autoriser l’app à accéder à ses données.</p>

<p><strong>Si l’utilisateur autorise l&#39;éditeur à accéder à son compte</strong> il sera redirigé vers:
<code>${url de redirection vers votre application}?code=${code_d_autorisation}</code></p>

<p><strong>Si l’utilisateur refuse l&#39;éditeur à accéder à son compte</strong>, il sera redirigé vers:
<code>${url de redirection vers votre application}?error_reason=user_denied&amp;error=access_denied&amp;error_description=Permissions+error</code></p>
<h2 id='echanger-le-code-d-39-autorisation-contre-un-token-d-39-acces'>Echanger le code d&#39;autorisation contre un token d&#39;accès</h2>
<p>Lorsque le code d&#39;autorisation est reçu, il doit être échangé contre un token d’accès à l’aide d’un point de terminaison. L’appel doit être effectué de serveur à serveur étant donné qu’il nécessite l’utilisation de votre clé secrète. (Votre clé secrète ne doit jamais se retrouver dans le code client.)</p>

<p>Pour obtenir un token d’accès, passez un appel HTTP GET au point de terminaison OAuth suivant :</p>
<pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/oauth/token?</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>

client_id={votre_identifiant_editeur}&amp;redirect_uri={url_de_redirection}&amp;client_secret={votre_secret_editeur}code={code_d_autorisation}&amp;grant_type=authorization_code
</code></pre>
<p>Ce point de terminaison doit présenter les paramètres suivants :</p>

<p><strong>client_id</strong>
Votre id editeur</p>

<p><strong>redirect_uri</strong>
Cet argument est requis et doit être identique au request_uri initial que vous avez utilisé lorsque vous avez commencé le processus de connexion OAuth.</p>

<p><strong>client_secret</strong>
Votre clé secrète unique. Cette clé secrète ne doit jamais être intégrée au code côté client ni à des fichiers binaires pouvant être décompilés. Elle doit absolument rester secrète étant donné qu’elle joue un rôle prépondérant dans la protection de votre app et de toutes les personnes qui l’utilisent.</p>

<p><strong>code</strong>
Le paramètre reçu issu de la redirection de la boîte de dialogue Login mentionnée plus haut.</p>

<p><strong>grant_type</strong>
doit être égal à <code>authorization_code</code></p>

<p>Réponse</p>

<p>La réponse que vous recevez de ce point de terminaison est renvoyée au format JSON. Si le renvoi s’est bien déroulé, il s’agit de :</p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">access-token</span><span class="p">},</span><span class="w">
    </span><span class="s2">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">seconds-til-expiration</span><span class="p">},</span><span class="w">
    </span><span class="s2">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">refresh-token</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>L&#39;access token vous permettra par la suite de passer des requetes sur l&#39;api Emjpm relative à cet utilisateur et votre application.</p>

<p>L&#39;utilisateur peut révoquer l&#39;accès d&#39;un logiciel métier à son compte eMJPM.</p>
<h1 id='mesures'>Mesures</h1><h2 id='l-39-objet-mesure'>L&#39;objet mesure</h2>
<blockquote>
<p>L&#39;objet mesure</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">138732</span><span class="p">,</span><span class="w">
  </span><span class="s2">"code_postal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75015"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ville"</span><span class="p">:</span><span class="w"> </span><span class="s2">"paris"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"annee_naissance"</span><span class="p">:</span><span class="w"> </span><span class="mi">1989</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_nomination"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_fin_mesure"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"numero_dossier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"354354354354"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"numero_rg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RG4354354354"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"antenne_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">48.8402</span><span class="p">,</span><span class="w">
  </span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.29356</span><span class="p">,</span><span class="w">
  </span><span class="s2">"pays"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"lieu_vie"</span><span class="p">:</span><span class="w"> </span><span class="s2">"etablissement"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type_etablissement"</span><span class="p">:</span><span class="w"> </span><span class="s2">"autre_etablissement_s_ms"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"civilite"</span><span class="p">:</span><span class="w"> </span><span class="s2">"monsieur"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cause_sortie"</span><span class="p">:</span><span class="w"> </span><span class="s2">"caducite"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_premier_mesure"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_protection_en_cours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"resultat_revision"</span><span class="p">:</span><span class="w"> </span><span class="s2">"allegement"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"etats"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"date_changement_etat"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"nature_mesure"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mesure_accompagnement_judiciaire"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"champ_mesure"</span><span class="p">:</span><span class="w"> </span><span class="s2">"protection_bien_personne"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"lieu_vie"</span><span class="p">:</span><span class="w"> </span><span class="s2">"etablissement"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"code_postal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75015"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ville"</span><span class="p">:</span><span class="w"> </span><span class="s2">"paris"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"pays"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FR"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type_etablissement"</span><span class="p">:</span><span class="w"> </span><span class="s2">"autre_etablissement_s_ms"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"etablissement_siret"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"ressources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"annee"</span><span class="p">:</span><span class="w"> </span><span class="mi">2010</span><span class="p">,</span><span class="w">
      </span><span class="s2">"niveau_ressource"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
      </span><span class="s2">"prestations_sociales"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"PCH"</span><span class="p">,</span><span class="s2">"RSA"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='attributs'>Attributs</h3>
<p><strong>id</strong> <code>number</code></p>

<p>ID de la mesure.</p>

<p><strong>annee_naissance</strong> <code>number</code></p>

<p>Année de naissance de la personne.</p>

<p><strong>date_nomination</strong> <code>string</code></p>

<p>Date de jugement ou ordonnance de nomination (yyyy-MM-dd)</p>

<p><strong>date_fin_mesure</strong> <code>string</code></p>

<p>Date de fin de la mesure de protection (yyyy-MM-dd)</p>

<p><strong>numero_dossier</strong> <code>string</code></p>

<p>Numéro de dossier de la mesure.</p>

<p><strong>numero_rg</strong> <code>string</code></p>

<p>Numéro RG de la mesure.</p>

<p><strong>antenne_id</strong> <code>number</code></p>

<p>Dans le cas d&#39;un service mandataire, identifiant unique emjpm de l&#39;antenne&#39;</p>

<p><strong>latitude</strong> <code>number</code></p>

<p><strong>longitude</strong> <code>number</code></p>

<p><strong>civilite</strong> <code>string</code></p>

<p>Civilité de la personne, les valeurs possibles sont &quot;monsieur&quot; et &quot;madame&quot;.</p>

<p><strong>cause_sortie</strong> <code>string</code></p>

<p><strong>date_premier_mesure</strong> <code>string</code></p>

<p>Date de la première mise sous protection juridique (yyyy-MM-dd)</p>

<p><strong>date_protection_en_cours</strong> <code>string</code></p>

<p>Date de la protection en cours (yyyy-MM-dd)</p>

<p><strong>resultat_revision</strong> <code>string</code></p>

<p>Résultat de la révision de la mesure de protection, les valeurs possibles sont &quot;mainlevee&quot;, &quot;reconduction&quot;, &quot;aggravation&quot;, &quot;allegement&quot;, &quot;dessaisissement_famille&quot;, ou &quot;dessaisissement_autre_mjpm&quot;.</p>

<p><strong>etats</strong> <code>array</code></p>

<p>Historique des états de la mesure</p>

<p><strong>etats.[*].date_changement_etat</strong> <code>string</code></p>

<p><strong>etats.[*].nature_mesure</strong> <code>string</code></p>

<p><strong>etats.[*].champ_mesure</strong> <code>string</code></p>

<p>Champ de la mesure de protection, les valeurs possibles sont &quot;protection_bien&quot;, &quot;protection_personne&quot;, ou &quot;protection_bien_personne&quot;.</p>

<p><strong>etats.[*].lieu_vie</strong> <code>string</code></p>

<p><strong>etats.[*].code_postal</strong> <code>string</code></p>

<p><strong>etats.[*].pays</strong> <code>string</code></p>

<p><strong>etats.[*].type_etablissement</strong> <code>string</code></p>

<p><strong>etats.[*].etablissement_siret</strong> <code>string</code></p>

<p><strong>ressources</strong> <code>array</code></p>

<p>Historique des mesures de protection</p>

<p><strong>ressources.[*].annee</strong> <code>number</code></p>

<p><strong>ressources.[*].niveau_ressource</strong> <code>number</code></p>

<p><strong>ressources.[*].prestations_sociales</strong> <code>string</code></p>
<h2 id='lister-toutes-les-mesures'>Lister toutes les mesures</h2>
<blockquote>
<p>GET /api/editors/mesures</p>
</blockquote>
<pre class="highlight plaintext"><code>GET /api/editors/mesures HTTP/1.1
Host: https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr/api/editors/mesures
Authorization: Bearer {access-token}
</code></pre>
<p>Retourne la liste de toutes les mesures associées à l&#39;utilisateur.
Les mesures retournées sont triées, avec la mesure la plus récente apparaissant en premier.</p>
<h3 id='parametres'>Paramètres</h3>
<p><strong>status</strong> (optionnel)</p>

<p>Retourne uniquement les mesures ayant ce status. Les valeurs possibles sont &quot;en_attente&quot;, &quot;en_cours&quot;, ou &quot;eteinte&quot;.</p>
<h3 id='retours'>Retours</h3>
<p>Retourne un tableau de <a href="/?javascript#l-39-objet-mesure">mesure</a>.</p>
<h2 id='recuperer-une-mesure'>Récupérer une mesure</h2>
<blockquote>
<p>GET /api/editors/mesures/:id</p>
</blockquote>
<pre class="highlight plaintext"><code>GET /api/editors/mesures/147853 HTTP/1.1
Host: https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr
Authorization: Bearer {access-token}
</code></pre>
<blockquote>
<p>REPONSE</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">138732</span><span class="p">,</span><span class="w">
  </span><span class="s2">"annee_naissance"</span><span class="p">:</span><span class="w"> </span><span class="mi">1989</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_nomination"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_fin_mesure"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"numero_dossier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"354354354354"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"numero_rg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RG4354354354"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"antenne_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">48.8402</span><span class="p">,</span><span class="w">
  </span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.29356</span><span class="p">,</span><span class="w">
  </span><span class="s2">"pays"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"civilite"</span><span class="p">:</span><span class="w"> </span><span class="s2">"monsieur"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cause_sortie"</span><span class="p">:</span><span class="w"> </span><span class="s2">"caducite"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_premier_mesure"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_protection_en_cours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"resultat_revision"</span><span class="p">:</span><span class="w"> </span><span class="s2">"allegement"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"etats"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"date_changement_etat"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"nature_mesure"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mesure_accompagnement_judiciaire"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"champ_mesure"</span><span class="p">:</span><span class="w"> </span><span class="s2">"protection_bien_personne"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"lieu_vie"</span><span class="p">:</span><span class="w"> </span><span class="s2">"etablissement"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"code_postal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75015"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ville"</span><span class="p">:</span><span class="w"> </span><span class="s2">"paris"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"pays"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FR"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type_etablissement"</span><span class="p">:</span><span class="w"> </span><span class="s2">"autre_etablissement_s_ms"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"etablissement_siret"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"ressources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"annee"</span><span class="p">:</span><span class="w"> </span><span class="mi">2010</span><span class="p">,</span><span class="w">
      </span><span class="s2">"niveau_ressource"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
      </span><span class="s2">"prestations_sociales"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"PCH"</span><span class="p">,</span><span class="s2">"RSA"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Récupère la mesure associée à l&#39;ID passé.</p>
<h3 id='retours-2'>Retours</h3>
<p>Retourne l&#39;objet <a href="/?javascript#l-39-objet-mesure">mesure</a>.
Si la mesure n&#39;existe pas, une <a href="/?javascript#errors">erreur</a> est retournée.</p>
<h2 id='creer-une-mesure'>Créer une mesure</h2>
<blockquote>
<p>POST /api/editors/mesures</p>
</blockquote>
<pre class="highlight plaintext"><code>POST /api/editors/mesures HTTP/1.1
Host: https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr
Authorization: Bearer {access-token}
Content-Type: application/json

{
    "numero_rg": "2020202020",
    "numero_dossier": "TESTES",
    "annee_naissance": 1957,
    "civilite": "monsieur",
    "date_premier_mesure": "2019-02-14",
    "date_nomination": "2019-02-14",
    "date_protection_en_cours": "2019-04-18",
    "tribunal_siret": "17690111400080",
    "etats": [
        {
            "date_changement_etat": "2020-09-19",
            "nature_mesure": "curatelle_simple",
            "champ_mesure": "protection_bien_personne",
            "lieu_vie": "domicile",
            "code_postal": "22190",
            "ville": "PLRIN SUR MER",
            "pays": "FR",
            "type_etablissement": "etablissement_handicapes"
        }
    ],
    "ressources": [
        {
            "annee": 2019,
            "niveau_ressource": 14246,
            "prestations_sociales": []
        }
    ]
}
</code></pre>
<p>Créer une mesure avec les paramètres passés.</p>
<h3 id='parametres-2'>Paramètres</h3>
<p>un objet <a href="/?javascript#l-39-objet-mesure">mesure</a>.</p>
<h3 id='retours-3'>Retours</h3>
<p>Retourne l&#39;objet <a href="/?javascript#l-39-objet-mesure">mesure</a> avec l&#39;identifiant de la mesure créée.</p>
<h2 id='modifier-une-mesure'>Modifier une mesure</h2>
<blockquote>
<p>PUT /api/editors/mesures/:id</p>
</blockquote>
<pre class="highlight plaintext"><code>PUT /api/editors/mesures/147853 HTTP/1.1
Host: https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr
Authorization: Bearer {access-token}
Content-Type: application/json

{
    "id": 147853
    "numero_rg": "2020202020",
    "numero_dossier": "TESTES",
    "annee_naissance": 1957,
    "civilite": "madame",
    "date_premier_mesure": "2019-02-14",
    "date_nomination": "2019-02-14",
    "date_protection_en_cours": "2019-04-18",
    "tribunal_siret": "17690111400080",
    "etats": [
        {
            "date_changement_etat": "2020-09-19",
            "nature_mesure": "curatelle_simple",
            "champ_mesure": "protection_bien_personne",
            "lieu_vie": "domicile",
            "code_postal": "22190",
            "ville": "PLRIN SUR MER",
            "pays": "FR",
            "type_etablissement": "etablissement_handicapes"
        }
    ],
    "ressources": [
        {
            "annee": 2019,
            "niveau_ressource": 14246,
            "prestations_sociales": []
        },
        {
            "annee": 2018,
            "niveau_ressource": 15500,
            "prestations_sociales": ["PCH","RSA"]
        }
    ]
}
</code></pre>
<p>Modifie la mesure avec les paramètres passés.</p>
<h3 id='parametres-3'>Paramètres</h3>
<p>un objet <a href="/?javascript#l-39-objet-mesure">mesure</a>.</p>
<h3 id='retours-4'>Retours</h3>
<p>Retourne l&#39;objet <a href="/?javascript#l-39-objet-mesure">mesure</a>.
Si la mesure n&#39;existe pas, une <a href="/?javascript#errors">erreur</a> est retournée.</p>
<h2 id='supprimer-une-mesure'>Supprimer une mesure</h2>
<blockquote>
<p>DELETE /api/editors/mesures/:id</p>
</blockquote>
<pre class="highlight plaintext"><code>DELETE /api/editors/mesures/147853 HTTP/1.1
Host: https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr
Authorization: Bearer {access-token}
</code></pre>
<blockquote>
<p>REPONSE</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"affected_rows"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Supprime la mesure associé à l&#39;ID passé.</p>
<h3 id='retours-5'>Retours</h3>
<p>Retourne le nombre de mesures <a href="/?javascript#l-39-objet-mesure">mesure</a> supprimées.
Si la mesure n&#39;existe pas, une <a href="/?javascript#errors">erreur</a> est retournée.</p>
<h2 id='supprimer-toutes-les-mesure'>Supprimer toutes les mesure</h2>
<blockquote>
<p>DELETE /api/editors/mesures</p>
</blockquote>
<pre class="highlight plaintext"><code>DELETE /api/editors/mesures HTTP/1.1
Host: https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr
Authorization: Bearer {access-token}
</code></pre>
<blockquote>
<p>REPONSE</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"affected_rows"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Supprime toutes les mesures de l&#39;utilisateur</p>
<h3 id='retours-6'>Retours</h3>
<p>Retourne le nombre de mesures <a href="/?javascript#l-39-objet-mesure">mesure</a> supprimées.</p>
<h1 id='antennes-service'>Antennes (service)</h1><h2 id='lister-toutes-les-antennes'>Lister toutes les antennes</h2>
<blockquote>
<p>GET /api/editors/service-antennes</p>
</blockquote>
<pre class="highlight plaintext"><code>HET /api/editors/service-antennes HTTP/1.1
Host: https://api-apitest-emjpm.dev2.fabrique.social.gouv.fr
Authorization: Bearer {access-token}
</code></pre>
<blockquote>
<p>RESPONSE</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">175</span><span class="p">,</span><span class="w">
    </span><span class="s2">"nom"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OULLINS"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"adresse"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12 RUE JACQUARD"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"code_postal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"69600"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ville"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OULLINS"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">176</span><span class="p">,</span><span class="w">
    </span><span class="s2">"nom"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RILLIEUX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"adresse"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1 RUE GABRIEL LADEVEZE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"code_postal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"69140"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ville"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RILLIEUX-LA-PAPE"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">174</span><span class="p">,</span><span class="w">
    </span><span class="s2">"nom"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GRIGNY"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"adresse"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10 RUE ROBESPIERRE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"code_postal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"69520"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ville"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GRIGNY"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p>Retourne la liste de toutes les antennes associées à votre service.</p>
<h1 id='errors'>Errors</h1>
<aside class="notice">
This error section is stored in a separate file in <code>includes/_errors.md</code>. Slate allows you to optionally separate out your docs into many files...just save them to the <code>includes</code> folder and add them to the top of your <code>index.md</code>'s frontmatter. Files are included in the order listed.
</aside>

<p>The Kittn API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request is invalid.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your API key is wrong.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden -- The kitten requested is hidden for administrators only.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified kitten could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed -- You tried to access a kitten with an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable -- You requested a format that isn&#39;t json.</td>
</tr>
<tr>
<td>410</td>
<td>Gone -- The kitten requested has been removed from our servers.</td>
</tr>
<tr>
<td>418</td>
<td>I&#39;m a teapot.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests -- You&#39;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable -- We&#39;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
